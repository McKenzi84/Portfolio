---
import HeaderLink from "./HeaderLink.astro";
import Hamburger from "./Hamburger.astro";
import ThemeModeButton from "./ThemeModeButton.astro";
import { SITE_URL } from "../../consts";
import LogoSVG from "../LogoSVG.astro";
---

<header class="sticky top-0 z-50">
  <nav class="bg-transparent backdrop-blur-md">
    <div class="mx-auto max-w-screen-xl flex flex-wrap items-center justify-between p-4">
      <!-- LOGO -->
      <a href={SITE_URL} class="flex items-center gap-3" aria-label="Go to homepage">
        <LogoSVG size={40} />
      </a>

      <!-- RIGHT CONTROLS -->
      <div class="flex items-center gap-2 md:order-2">
        <Hamburger />
        <ThemeModeButton />
      </div>

      <!-- NAVIGATION -->
      <div id="navbar-default" class="hidden w-full md:block md:w-auto">
        <ul
          class="mt-4 flex flex-col gap-2 rounded-lg
            bg-white/70 backdrop-blur-md
            dark:bg-gray-900/70
            md:mt-0 md:flex-row md:gap-8
            md:bg-transparent md:backdrop-blur-0"
        >
          <HeaderLink href="/">Home</HeaderLink>
          <HeaderLink href="/about">About</HeaderLink>

          <!-- DROPDOWN -->
          <li class="relative">
            <button
              type="button"
              data-resources-toggle
              aria-expanded="false"
              class="flex items-center gap-1
                py-2 px-3 md:p-0
                font-bold
                text-gray-900 hover:text-primary-500
                dark:text-white
                focus:outline-none"
            >
              Resources
              <svg class="w-4 h-4 transition-transform" viewBox="0 0 24 24" aria-hidden="true">
                <path d="m6 9 6 6 6-6" fill="none" stroke="currentColor" stroke-width="2"></path>
              </svg>
            </button>

            <!-- SUBMENU -->
            <ul
              data-resources-menu
              class="hidden
                mt-2 ml-4 flex flex-col gap-1
                md:ml-0
                md:absolute
                md:top-full
                md:left-0
                md:mt-3
                md:min-w-[14rem]
                md:rounded-lg
                md:border md:border-white/10
                md:bg-white/80 md:backdrop-blur-md
                md:shadow-lg
                md:dark:bg-gray-900/80
                md:p-2"
            >
              <HeaderLink href="/posts">Posts</HeaderLink>
              <HeaderLink href="/resources">Resources</HeaderLink>
              <HeaderLink href="/flowbite-component">Flowbite</HeaderLink>
            </ul>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- DROPDOWN SCRIPT -->
  <script>
    const button = document.querySelector("[data-resources-toggle]");
    const menu = document.querySelector("[data-resources-menu]");

    button?.addEventListener("click", () => {
      const expanded = button.getAttribute("aria-expanded") === "true";
      button.setAttribute("aria-expanded", String(!expanded));
      menu?.classList.toggle("hidden");

      const icon = button.querySelector("svg");
      icon?.classList.toggle("rotate-180");
    });
  </script>

  <!-- THEME SWITCH SCRIPT -->
  <script>
    import "../../scripts/dark-mode-switch";
  </script>
</header>
